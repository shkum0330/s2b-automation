Spring Boot 2.4부터 도입된 spring.config.import 기능은 설정 파일을 분리해서 관리할 수 있게 해준다. 이때 import: optional:env.yml처럼 optional 접두사를 사용하는 것을 권장하는 이유가 있다.

### 1. 원활한 팀 협업

`env.yml` 파일은 API 키와 같은 민감 정보를 담고 있어 보통 `.gitignore`에 등록하여 git 저장소에 올리지 않는다.

프로젝트 팀에 새로운 팀원이 합류했다고 가정해 보자.

- `optional`이 없다면: 새로운 팀원이 프로젝트를 처음 내려받았을 때, `env.yml` 파일이 없다는 이유만으로 애플리케이션 실행에 실패한다. 팀원은 불필요한 오류 해결 과정을 겪어야 한다.
- `optional`이 있다면: 새로운 팀원은 `env.yml` 파일이 없어도 애플리케이션을 바로 실행할 수 있다. API 키가 필요한 기능은 동작하지 않겠지만, 다른 부분의 개발을 즉시 시작할 수 있다.

### 2. 유연한 배포 환경

CI/CD 서버나 Docker, 쿠버네티스 같은 배포 환경에서는 파일(`env.yml`) 형태가 아닌, **시스템 환경 변수**나 **ConfigMap/Secret**을 통해 통해 API 키를 주입하는 경우가 많다.

Spring Boot는 설정 값에 우선순위가 있으며, 환경 변수는 .yml 파일보다 우선순위가 높다.

- `optional`이 없다면: 배포 환경에 `env.yml` 파일이 없다는 이유로 애플리케이션 시작에 실패한다. 환경 변수로 값을 모두 제공했음에도 불구하고 불필요한 파일 존재 여부를 검사하게 된다.
- `optional`이 있다면: 배포 환경에 `env.yml` 파일이 없어도 정상적으로 시작하고, 환경 변수를 통해 주입된 설정 값을 우선적으로 사용하여 애플리케이션을 구동한다.

## optional과 default value

optional은 애플리케이션의 실행 시작을 보장하지만, 설정값이 null이라 발생하는 런타임 오류까지 막아주지는 않는다.

optional 파일에도, 환경 변수에도 설정값이 없는 최악의 경우를 대비해 코드 내에서 기본값을 설정하는 것이 좋다.
```java
@Value("${my.api.key:default-key-if-missing}")
private String apiKey;
```

결론은, `optional` 접두사는 애플리케이션의 실행을 특정 설정 파일의 존재 여부와 분리하여, 어떤 환경에서든 더 유연하고 안정적으로 동작하도록 만들 수 있다.